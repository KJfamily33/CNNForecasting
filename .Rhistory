colnames(data)
head(data)
## remove na
data = na.omit(data)
data$IdeologyD <- abs(data$IdeologyU - data$IdeologyR)
data$EngagementD <- abs(data$EngagementR - data$EngagementU)
library(MASS)
h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
RoomTemp + RoomStudy + IdeologyU + IdeologyR + EngagementU + EngagementR +
IdeologyD + EngagementD,
data = data)
library(MASS)
h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
RoomTemp + RoomStudy + IdeologyU + IdeologyR + EngagementU + EngagementR +
IdeologyD + EngagementD,
data = data)
summary(h1.ols)
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               RoomTemp + RoomStudy + IdeologyU + IdeologyR + EngagementU + EngagementR +
#               IdeologyD + EngagementD,
#             data = data)
h1.ols <- lm(Compatibility ~ IdeologyU + IdeologyR + EngagementU + EngagementR +
IdeologyD + EngagementD, data = data)
summary(h1.ols)
qqPlot(lm(Compatibility ~ IdeologyU + IdeologyR + EngagementU + EngagementR +
IdeologyD + EngagementD, data = data))
## test for heteroskedasticity
bptest(ols)
## test for heteroskedasticity
bptest(h1.ols)
## test for colinearity
vif(ols)
## test for colinearity
vif(h1.ols)
plot(h1.ols, which=1, col=c("blue"))
AIC(h1.ols)
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               RoomTemp + RoomStudy + IdeologyU + IdeologyR + EngagementU + EngagementR +
#               IdeologyD + EngagementD,
#             data = data)
h1.ols <- lm(Compatibility ~ EngagementU + EngagementR +
IdeologyD + EngagementD, data = data)
summary(h1.ols)
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               RoomTemp + RoomStudy + IdeologyU + IdeologyR + EngagementU + EngagementR +
#               IdeologyD + EngagementD,
#             data = data)
h1.ols <- lm(Compatibility ~ EngagementU + EngagementR + EngagementD +
IdeologyD + IdeologyU + IdeologyR, data = data)
summary(h1.ols)
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               RoomTemp + RoomStudy + IdeologyU + IdeologyR + EngagementU + EngagementR +
#               IdeologyD + EngagementD,
#             data = data)
h1.ols <- lm(Compatibility ~
IdeologyD + IdeologyU + IdeologyR, data = data)
summary(h1.ols)
qqPlot(lm(Compatibility ~ IdeologyU + IdeologyR + IdeologyD, data = data))
plot(h1.ols, which=1, col=c("blue"))
nrow(data)
h1.ols <- lm(Compatibility ~
IdeologyD + IdeologyU + IdeologyR, data = data[1:80,])
pred.h1.ols <- predict(h1.ols, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], pred.h1.ols)
summary(data$Compatibility)
data$Compatibility
library(nnet)
h1.logit<-multinom(Compatibility ~IdeologyD + IdeologyU + IdeologyR, data = data, maxit=1000)
summary(h1.logit)
AIC(h1.ols)
AIC(h1.logit)
h1.logit<-multinom(Compatibility ~IdeologyD + IdeologyU + IdeologyR, data = data[1:80,], maxit=1000)
pred.h1.logit <- predict(h1.logit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], pred.h1.logit)
h1.logit<-multinom(Compatibility ~IdeologyD + IdeologyU + IdeologyR, data = data[1:80,], maxit=1000)
pred.h1.logit <- predict(h1.logit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], as.numeric(pred.h1.logit))
h1.ologit <- polr(Compatibility ~ IdeologyD + IdeologyU + IdeologyR, data = data)
h1.ologit <- polr(Compatibility ~ IdeologyD + IdeologyU + IdeologyR, data = data)
## transform Compatibility into factor
data$Compatibilityf <- as.factor(data$Compatibility)
## fit the ordered logit model
h1.ologit <- polr(Compatibilityf ~ IdeologyD + IdeologyU + IdeologyR, data = data)
## transform Compatibility into factor
data$Compatibilityf <- as.factor(data$Compatibility)
## fit the ordered logit model
h1.ologit <- polr(Compatibilityf ~ IdeologyD + IdeologyU + IdeologyR, data = data)
summary(h1.ologit)
AIC(h1.ols)
h1.ologit<-polr(Compatibilityf ~ IdeologyD + IdeologyU + IdeologyR, data = data[1:80,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], as.numeric(pred.h1.ologit))
h1.ologit<-polr(Compatibilityf ~ IdeologyD + IdeologyU + IdeologyR, data = data[1:80,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[81:103,])
cor(data[81:103,"Compatibilityf"], as.numeric(pred.h1.ologit))
pred.h1.ologit
h1.logit<-multinom(Compatibility ~ EngagementD + EngagementU + EngagementR + IdeologyD + IdeologyU + IdeologyR, data = data[1:80,], maxit=1000)
pred.h1.logit <- predict(h1.logit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], as.numeric(pred.h1.logit))
h1.logit<-multinom(Compatibility ~ IdeologyD + IdeologyU + IdeologyR, data = data[1:80,], maxit=1000)
pred.h1.logit <- predict(h1.logit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], as.numeric(pred.h1.logit))
h1.ologit<-polr(Compatibilityf ~ EngagementD + EngagementU + EngagementR +IdeologyD + IdeologyU + IdeologyR, data = data[1:80,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], as.numeric(pred.h1.ologit))
pred.h1.ologit
## transform Compatibility into factor
data$Compatibilityf <- as.factor(data$Compatibility)
## fit the ordered logit model
h1.ologit <- polr(Compatibilityf ~ EngagementD + EngagementU + EngagementR +IdeologyD + IdeologyU + IdeologyR, data = data)
summary(h1.ologit)
length(data)
nrow(data)
h1.ologit<-polr(Compatibilityf ~ IdeologyD + IdeologyU + IdeologyR, data = data[1:80,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], as.numeric(pred.h1.ologit))
data[81:103,"Compatibility"]
h1.ologit<-polr(Compatibilityf ~ IdeologyD +IdeologyR, data = data[1:80,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], as.numeric(pred.h1.ologit))
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
#               RoomTemp + RoomStudy,
#             data = data)
h1.ols <- lm(Compatibility ~IdeologyD, data = data)
summary(h1.ols)
h1.ols <- lm(Compatibility ~IdeologyD , data = data[1:80,])
pred.h1.ols <- predict(h1.ols, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], pred.h1.ols)
qqPlot(lm(Compatibility ~ IdeologyU , data = data))
plot(h1.ols, which=1, col=c("blue"))
library(nnet)
h1.logit<-multinom(Compatibility ~ IdeologyD , data = data, maxit=1000)
summary(h1.logit)
AIC(h1.ols)
AIC(h1.logit)
h1.logit<-multinom(Compatibility ~ IdeologyD , data = data[1:80,], maxit=1000)
pred.h1.logit <- predict(h1.logit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], as.numeric(pred.h1.logit))
## transform Compatibility into factor
data$Compatibilityf <- as.factor(data$Compatibility)
## fit the ordered logit model
h1.ologit <- polr(Compatibilityf ~ IdeologyD , data = data)
summary(h1.ologit)
h1.ologit<-polr(Compatibilityf ~ IdeologyD , data = data[1:80,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], as.numeric(pred.h1.ologit))
h1.ologit<-polr(Compatibilityf ~ IdeologyD +  IdeologyU + IdeologyR, data = data[1:80,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[81:103,])
cor(data[81:103,"Compatibility"], as.numeric(pred.h1.ologit))
h1.ologit<-polr(Compatibilityf ~ IdeologyD +  IdeologyU + IdeologyR, data = data[1:90,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h1.ologit))
h1.ologit<-polr(Compatibilityf ~ IdeologyD, data = data[1:90,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h1.ologit))
## transform Compatibility into factor
data$Compatibilityf <- as.factor(data$Compatibility)
## fit the ordered logit model
h1.ologit <- polr(Compatibilityf ~ IdeologyD +IdeologyU + IdeologyR, data = data)
summary(h1.ologit)
h1.logit<-multinom(Compatibility ~ IdeologyD+  IdeologyU + IdeologyR , data = data[1:90,], maxit=1000)
pred.h1.logit <- predict(h1.logit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h1.logit))
library(nnet)
h1.logit<-multinom(Compatibility ~ IdeologyD +  IdeologyU + IdeologyR, data = data, maxit=1000)
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
#               RoomTemp + RoomStudy,
#             data = data)
h1.ols <- lm(Compatibility ~IdeologyD +  IdeologyU + IdeologyR, data = data)
summary(h1.ols)
h1.ols <- lm(Compatibility ~IdeologyD , data = data[1:90,])
pred.h1.ols <- predict(h1.ols, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], pred.h1.ols)
qqPlot(lm(Compatibility ~ IdeologyU , data = data))
plot(h1.ols, which=1, col=c("blue"))
qqPlot(h1.ols <- lm(Compatibility ~IdeologyD +  IdeologyU + IdeologyR, data = data))
qqPlot(lm(Compatibility ~IdeologyD +  IdeologyU + IdeologyR, data = data))
h1.ols <- lm(Compatibility ~IdeologyD +  IdeologyU + IdeologyR, data = data)
plot(h1.ols, which=1, col=c("blue"))
library(nnet)
h1.logit<-multinom(Compatibility ~ IdeologyD +  IdeologyU + IdeologyR, data = data, maxit=1000)
summary(h1.logit)
AIC(h1.ols)
AIC(h1.logit)
h1.logit<-multinom(Compatibility ~ IdeologyD+  IdeologyU + IdeologyR , data = data[1:90,], maxit=1000)
pred.h1.logit <- predict(h1.logit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h1.logit))
## transform Compatibility into factor
data$Compatibilityf <- as.factor(data$Compatibility)
## fit the ordered logit model
h1.ologit <- polr(Compatibilityf ~ IdeologyD +IdeologyU + IdeologyR, data = data)
summary(h1.ologit)
h1.ologit<-polr(Compatibilityf ~ IdeologyD + IdeologyU + IdeologyR, data = data[1:90,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h1.ologit))
AIC(h1.ols)
AIC(h1.ologit)
AIC(h1.ols)
AIC(h1.ologit)
h1.ologit<-polr(Compatibilityf ~ IdeologyD + IdeologyU + IdeologyR, data = data[1:90,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h1.ologit))
h1.ologit<-polr(Compatibilityf ~ IdeologyD + IdeologyU + IdeologyR, data = data[1:90,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h1.ols))
cor(data[91:103,"Compatibility"], as.numeric(pred.h1.ologit))
# Print the Odds ratios and CIs
ci <- exp(confint(h1.ologit))
exp(cbind(OR = coef(h1.ologit), ci))
confint(h1.ologit)
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
#               RoomTemp + RoomStudy,
#             data = data)
h2.ols <- lm(Compatibility ~ EngagementU + EngagementR, data = data)
summary(h2.ols)
h1.ols <- lm(Compatibility ~IdeologyD + IdeologyU + IdeologyR , data = data[1:90,])
pred.h1.ols <- predict(h1.ols, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], pred.h1.ols)
AIC(h1.ols)
AIC(h1.logit)
AIC(h1.ols)
AIC(h1.ologit)
h1.ologit<-polr(Compatibilityf ~ IdeologyD + IdeologyU + IdeologyR, data = data[1:90,])
pred.h1.ologit <- predict(h1.ologit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h1.ols))
cor(data[91:103,"Compatibility"], as.numeric(pred.h1.ologit))
h2.ols <- lm(Compatibility ~ EngagementU + EngagementR, data = data[1:90,])
pred.h2.ols <- predict(h2.ols, newdata = data[91:103,])
cor(data[92:103,"Compatibility"], pred.h2.ols)
h2.ols <- lm(Compatibility ~ EngagementU + EngagementR, data = data[1:90,])
pred.h2.ols <- predict(h2.ols, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], pred.h2.ols)
qqPlot(lm(Compatibility ~ EngagementU + EngagementR, data = data))
h2.ols <- lm(Compatibility ~ EngagementU + EngagementR, data = data)
plot(h2.ols, which=1, col=c("blue"))
library(nnet)
h2.logit<-multinom(Compatibility ~  EngagementU + EngagementR, data = data, maxit=1000)
summary(h2.logit)
AIC(h2.ols)
AIC(h2.logit)
AIC(h2.ols)
AIC(h2.logit)
h2.logit<-multinom(Compatibility ~  EngagementU + EngagementR, data = data[1:90,], maxit=1000)
pred.h2.logit <- predict(h2.logit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.logit))
h2.logit<-multinom(Compatibility ~  EngagementU + EngagementR, data = data[1:90,], maxit=1000)
pred.h2.logit <- predict(h2.logit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.ols))
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.logit))
## transform Compatibility into factor
data$Compatibilityf <- as.factor(data$Compatibility)
## fit the ordered logit model
h2.ologit <- polr(Compatibilityf ~ EngagementU + EngagementR, data = data)
summary(h2.ologit)
AIC(h2.ols)
AIC(h2.ologit)
AIC(h2.ols)
AIC(h2.ologit)
h2.ologit<-polr(Compatibilityf ~ EngagementU + EngagementR, data = data[1:90,])
pred.h2.ologit <- predict(h2.ologit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.ols))
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.ologit))
## transform Compatibility into factor
data$Compatibilityf <- as.factor(data$Compatibility)
## fit the ordered logit model
h2.ologit <- polr(Compatibilityf ~ EngagementD + EngagementU + EngagementR, data = data)
summary(h2.ologit)
AIC(h2.ols)
AIC(h2.ologit)
h2.ologit<-polr(Compatibilityf ~ EngagementD + EngagementU + EngagementR, data = data[1:90,])
pred.h2.ologit <- predict(h2.ologit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.ols))
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.ologit))
h2.logit<-multinom(Compatibility ~ EngagementD + EngagementU + EngagementR, data = data[1:90,], maxit=1000)
pred.h2.logit <- predict(h2.logit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.ols))
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.logit))
library(nnet)
h2.logit<-multinom(Compatibility ~ EngagementD + EngagementU + EngagementR, data = data, maxit=1000)
summary(h2.logit)
AIC(h2.ols)
AIC(h2.logit)
h2.ols <- lm(Compatibility ~ EngagementD +EngagementU + EngagementR, data = data)
plot(h2.ols, which=1, col=c("blue"))
qqPlot(lm(Compatibility ~ EngagementD +EngagementU + EngagementR, data = data))
h2.ols <- lm(Compatibility ~ EngagementD +EngagementU + EngagementR, data = data[1:90,])
pred.h2.ols <- predict(h2.ols, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], pred.h2.ols)
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
#               RoomTemp + RoomStudy,
#             data = data)
h2.ols <- lm(Compatibility ~ EngagementD +EngagementU + EngagementR, data = data)
summary(h2.ols)
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
#               RoomTemp + RoomStudy,
#             data = data)
h2.ols <- lm(Compatibility ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = data)
summary(h2.ols)
h2.ols <- lm(Compatibility ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = data[1:90,])
pred.h2.ols <- predict(h2.ols, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], pred.h2.ols)
qqPlot(lm(Compatibility ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = data))
h2.ols <- lm(Compatibility ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = data)
plot(h2.ols, which=1, col=c("blue"))
library(nnet)
h2.logit<-multinom(Compatibility ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = data, maxit=1000)
summary(h2.logit)
AIC(h2.ols)
AIC(h2.logit)
h2.logit<-multinom(Compatibility ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = data[1:90,], maxit=1000)
pred.h2.logit <- predict(h2.logit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.ols))
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.logit))
## transform Compatibility into factor
data$Compatibilityf <- as.factor(data$Compatibility)
## fit the ordered logit model
h2.ologit <- polr(Compatibilityf ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = data)
summary(h2.ologit)
AIC(h2.ols)
AIC(h2.ologit)
h2.ologit<-polr(Compatibilityf ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = data[1:90,])
pred.h2.ologit <- predict(h2.ologit, newdata = data[91:103,])
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.ols))
cor(data[91:103,"Compatibility"], as.numeric(pred.h2.ologit))
summary(h2.ols)
qqPlot(lm(Compatibility ~IdeologyD +  IdeologyU + IdeologyR, data = data))
h1.ols <- lm(Compatibility ~IdeologyD +  IdeologyU + IdeologyR, data = data)
plot(h1.ols, which=1, col=c("blue"))
## test for heteroskedasticity
bptest(h1.ols)
## test for heteroskedasticity
bptest(ols)
## test for heteroskedasticity
bptest(h1.ols)
h1.logit <- glm(Compatibility ~IdeologyD +  IdeologyU + IdeologyR, data = data, family = "binomial")
h1.logit <- glm(Compatibility ~IdeologyD +  IdeologyU + IdeologyR, data = data, family = "poisson")
h1.logit <- lm(log(Compatibility) ~IdeologyD +  IdeologyU + IdeologyR, data = data, family = "poisson")
h1.logit <- lm(log(Compatibility) ~IdeologyD +  IdeologyU + IdeologyR, data = data)
BIC(h2.ols)
BIC(h2.logit)
BIC(h2.ologit)
qqPlot(lm(Compatibility ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = data))
h2.ols <- lm(Compatibility ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = data)
plot(h2.ols, which=1, col=c("blue"))
influencePlot(h2.ols)
h1.ols$coefficients
h1.ols$coefficients[1]
h1.ols$coefficients[2]
h2.ols$coefficients[2]
h2.ols$coefficients
h2.ols$coefficients[4]
h2.ols$coefficients[5]
B = 1000
outputs.h1 = rep(NA, B)
outputs.h2.R = rep(NA, B)
outputs.h2.U = rep(NA, B)
for (i in 1:B){
ids <- sample(nrow(model.frame(data)),replace = TRUE)
new.df <- model.frame(data)[ids,]
# fit model
h1.boot <- lm(Compatibility ~ IdeologyD + IdeologyR + IdeologyU, data = new.df)
h2.boot <- lm(Compatibility ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = new.df)
# store coefficient
outputs.h1[i] = h1.boot$coefficients[2]
outputs.h2.R[i] = h2.boot$coefficients[5]
outputs.h2.U[i] = h2.boot$coefficients[6]
}
quantile(outputs.h1, c(0.025,0.5,0.975))
quantile(outputs.h1, c(0.025,0.5,0.975))
quantile(outputs.h2.R, c(0.025,0.5,0.975))
quantile(outputs.h2.U, c(0.025,0.5,0.975))
B = 10000
outputs.h1 = rep(NA, B)
outputs.h2.R = rep(NA, B)
outputs.h2.U = rep(NA, B)
for (i in 1:B){
ids <- sample(nrow(model.frame(data)),replace = TRUE)
new.df <- model.frame(data)[ids,]
# fit model
h1.boot <- lm(Compatibility ~ IdeologyD + IdeologyR + IdeologyU, data = new.df)
h2.boot <- lm(Compatibility ~ IdeologyD*EngagementR + IdeologyD*EngagementU, data = new.df)
# store coefficient
outputs.h1[i] = h1.boot$coefficients[2]
outputs.h2.R[i] = h2.boot$coefficients[5]
outputs.h2.U[i] = h2.boot$coefficients[6]
}
quantile(outputs.h1, c(0.025,0.5,0.975))
quantile(outputs.h2.R, c(0.025,0.5,0.975))
quantile(outputs.h2.U, c(0.025,0.5,0.975))
sd(outputs.h1)
sd(outputs.h2.R)
sd(outputs.h2.U)
sd(outputs.h1)
sd(outputs.h2.R)
sd(outputs.h2.U)
library(MASS)
library(glmnet)
h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
RoomTemp + RoomStudy,
data = data)
library(MASS)
library(glmnet)
h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
RoomTemp + RoomStudy,
data = data)
summary(h1.ols)
data <- read.csv("DormSurvey.csv", header = TRUE)
library(MASS)
library(glmnet)
h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
RoomTemp + RoomStudy,
data = data)
data$IdeologyD <- abs(data$IdeologyU - data$IdeologyR)
library(MASS)
library(glmnet)
h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
RoomTemp + RoomStudy,
data = data)
library(MASS)
library(glmnet)
h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
IdeologyD + IdeologyU + IdeologyR + EngagementU + EngagementR +
RoomTemp + RoomStudy,
data = data)
summary(h1.ols)
colnames(data)
Y <- data$Compatibility
X <- data[,-7]
cvfit <- cv.glmnet(x = X, y = Y, alpha = 1, nlambda = 1000, nfolds = 10)
head(X)
X <- model.matrix(formula, data) # Get the dependent variable, Y
X <- model.matrix(formula, data) # Get the dependent variable, Y
formula = Compatibility ~ Year + Double + DormStyle + Selection + Gender +
GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
IdeologyD + IdeologyU + IdeologyR + EngagementU + EngagementR +
RoomTemp + RoomStudy
library(MASS)
library(glmnet)
formula = Compatibility ~ Year + Double + DormStyle + Selection + Gender +
GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
IdeologyD + IdeologyU + IdeologyR + EngagementU + EngagementR +
RoomTemp + RoomStudy
h1.ols <- lm(formula, data = data)
summary(h1.ols)
X <- model.matrix(formula, data) # Get the dependent variable, Y
Y <- data[, 1]
cvfit <- cv.glmnet(x = X, y = Y, alpha = 1, nlambda = 1000, nfolds = 10)
cvfit$lambda.min
# Estimate lasso
lasso <- glmnet(x = X, y = Y, alpha = 1, lambda=cvfit$lambda.min)
# Print coefficients
lasso$beta
AIC(lasso)
LogLik(lasso)
logLik(lasso)
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
#               RoomTemp + RoomStudy,
#             data = data)
h1.ols <- lm(Compatibility ~ year + IdeologyD +  IdeologyU + IdeologyR, data = data)
library(MASS)
# h1.ols <- lm(Compatibility ~ Year + Double + DormStyle + Selection + Gender +
#               GenderNeut + Neat + Smokes + Bedtime + Roomnoise + SleepSettings +
#               IdeologyD + IdeologyU + IdeologyR + EngagementD + EngagementU + EngagementR +
#               RoomTemp + RoomStudy,
#             data = data)
h1.ols <- lm(Compatibility ~ Year + IdeologyD +  IdeologyU + IdeologyR, data = data)
summary(h1.ols)
h1.re<-lmer(formula=Compatibility~ IdeologyD +  IdeologyU + IdeologyR+ (1|Year), data = data)
summary(h1.re)
install.packages("tidyverse")
source('~/Documents/WashU/CSE515T/Code/Gaussian Process/main.R', echo=TRUE)
setwd("~/Documents/WashU/CSE515T/Code/Gaussian Process")
load("*.Rproj")
setwd("~/Documents/WashU/CSE515T/Code/Gaussian Process")
load("model.Rproj")
